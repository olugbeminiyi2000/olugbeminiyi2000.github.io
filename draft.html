<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Share</title>
    <style>
        /* Reset default margins and padding */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f3f4f6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 16px;
        }

        .container {
            width: 100%;
            max-width: 448px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 24px;
        }

        /* Snackbar */
        .snackbar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #10b981;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            z-index: 1000; /* Ensure it appears above other elements */
            min-width: 200px; /* Ensure visibility on smaller screens */
        }

        .snackbar.show {
            opacity: 1;
        }

        .snackbar-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
            padding: 4px;
        }

        .snackbar-close:hover {
            color: #e5e7eb;
        }

        /* Navigation */
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .navigation h1 {
            font-size: 24px;
            font-weight: 700;
        }

        .nav-buttons {
            display: flex;
            gap: 8px;
        }

        .nav-button-upload {
            color: #2563eb;
            font-weight: 600;
            background: none;
            border: none;
            cursor: pointer;
        }

        .nav-button {
            color: #4b5563;
            background: none;
            border: none;
            cursor: pointer;
        }

        .nav-button:hover {
            color: #2563eb;
        }

        /* Upload Section */
        .view {
            display: block;
        }

        .view.hidden {
            display: none;
        }

        .upload-section h2 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .upload-section p {
            color: #4b5563;
            margin-bottom: 16px;
        }

        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            max-width: 100%;
            margin-bottom: 16px;
        }

        .image-grid img,
        .image-grid .add-button {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
        }

        .add-button {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #e5e7eb;
            color: #2563eb;
            cursor: pointer;
            font-size: 16px;
        }

        .add-button:hover {
            background-color: #d1d5db;
        }

        .tags-section {
            margin-bottom: 16px;
        }

        .tags-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .tags-header label {
            font-weight: 600;
        }

        .tags-header span {
            color: #4b5563;
        }

        .tag-input {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            min-height: 40px;
            padding: 4px 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            background-color: white;
            cursor: text;
        }

        .tag-input .tag {
            background-color: #e5e7eb;
            border-radius: 9999px;
            padding: 4px 8px;
            margin: 2px;
            display: inline-flex;
            align-items: center;
        }

        .tag-input .tag .remove-tag {
            margin-left: 4px;
            cursor: pointer;
        }

        .default-tags {
            display: flex;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .default-tag {
            cursor: pointer;
            background-color: #f3f4f6;
            border-radius: 4px;
            padding: 4px 8px;
            margin: 2px;
            display: inline-block;
        }

        .default-tag:hover {
            background-color: #e5e7eb;
        }

        /* Actions */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .save-draft-button {
            color: #4b5563;
            background: none;
            border: none;
            cursor: pointer;
        }

        .save-draft-button:hover {
            color: #2563eb;
        }

        .action-buttons-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .draft-date {
            color: #4b5563;
        }

        .share-button {
            background-color: #2563eb;
            color: white;
            padding-left: 16px;
            padding-right: 16px;
            padding-top: 8px;
            padding-bottom: 8px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
        }

        /* Drafts Section */
        .drafts-section h2 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .drafts-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-height: 500px;
            overflow-y: auto;
        }

        .draft-box,
        .shared-box {
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 16px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .draft-box:hover,
        .shared-box:hover {
            background-color: #f3f4f6;
        }

        .draft-box .image-grid,
        .shared-box .image-grid {
            margin-bottom: 8px;
        }

        .draft-box .draft-header,
        .shared-box .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .draft-box .draft-header h3,
        .shared-box .post-header h3 {
            font-weight: 600;
        }

        .draft-box .draft-header span,
        .shared-box .post-header span {
            color: #4b5563;
            font-size: 14px;
        }

        .draft-box .tags,
        .shared-box .tags {
            display: flex;
            flex-wrap: wrap;
        }

        .draft-box .tag,
        .shared-box .tag {
            margin: 4px;
            background-color: #e5e7eb;
            border-radius: 9999px;
            padding: 4px 8px;
        }

        .back-to-upload-button {
            margin-top: 16px;
            color: #2563eb;
            background: none;
            border: none;
            cursor: pointer;
        }

        /* Shared Section */
        .shared-section h2 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .shared-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
            max-height: 500px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Snackbar -->
        <div id="snackbar" class="snackbar">
            <span>Draft saved!</span>
            <button class="snackbar-close">×</button>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <h1>Design Share</h1>
            <div class="nav-buttons">
                <button id="upload-btn" class="nav-button-upload">Upload</button>
                <button id="drafts-btn" class="nav-button">Drafts</button>
                <button id="shared-btn" class="nav-button">Shared</button>
            </div>
        </div>

        <!-- Upload Section -->
        <div id="upload-view" class="view">
            <div class="upload-section">
                <h2>Share your work</h2>
                <p>What have you been working on?</p>

                <!-- Image Grid -->
                <div id="image-grid" class="image-grid">
                    <div id="add-image-btn" class="add-button">+ Add another</div>
                </div>
                <input type="file" id="image-input" accept="image/*" class="view hidden" multiple>

                <!-- Tags Section -->
                <div class="tags-section">
                    <div class="tags-header">
                        <label>Add tags</label>
                        <span id="tag-counter">10 tags remaining</span>
                    </div>
                    <!-- Custom Tag Input Simulation -->
                    <div id="tag-input" class="tag-input" contenteditable="true"></div>
                    <!-- Default Tags -->
                    <div class="default-tags">
                        <span class="default-tag" data-tag="Web Design">Web Design</span>
                        <span class="default-tag" data-tag="Website Design">Website Design</span>
                        <span class="default-tag" data-tag="Webflow">Webflow</span>
                        <span class="default-tag" data-tag="UI">UI</span>
                        <span class="default-tag" data-tag="UX">UX</span>
                        <span class="default-tag" data-tag="UI Design">UI Design</span>
                        <span class="default-tag" data-tag="UX Design">UX Design</span>
                        <span class="default-tag" data-tag="Team Page">Team Page</span>
                        <span class="default-tag" data-tag="About Us">About Us</span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="action-buttons">
                    <button id="save-draft-btn" class="save-draft-button">Save as draft</button>
                    <div class="action-buttons-right">
                        <span id="draft-date" class="draft-date"></span>
                        <button id="share-btn" class="share-button">Share now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Drafts Section -->
        <div id="drafts-view" class="view hidden">
            <div class="drafts-section">
                <h2>Drafts</h2>
                <div id="drafts-list" class="drafts-list"></div>
                <button id="back-to-upload-btn" class="back-to-upload-button">Back to Upload</button>
            </div>
        </div>

        <!-- Shared Section -->
        <div id="shared-view" class="view hidden">
            <div class="shared-section">
                <h2>Shared Posts</h2>
                <div id="shared-list" class="shared-list"></div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const uploadView = document.getElementById('upload-view');
        const draftsView = document.getElementById('drafts-view');
        const sharedView = document.getElementById('shared-view');
        const uploadBtn = document.getElementById('upload-btn');
        const draftsBtn = document.getElementById('drafts-btn');
        const sharedBtn = document.getElementById('shared-btn');
        const imageGrid = document.getElementById('image-grid');
        const addImageBtn = document.getElementById('add-image-btn');
        const imageInput = document.getElementById('image-input');
        const tagInput = document.getElementById('tag-input');
        const tagCounter = document.getElementById('tag-counter');
        const saveDraftBtn = document.getElementById('save-draft-btn');
        const draftDate = document.getElementById('draft-date');
        const shareBtn = document.getElementById('share-btn');
        const draftsList = document.getElementById('drafts-list');
        const backToUploadBtn = document.getElementById('back-to-upload-btn');
        const sharedList = document.getElementById('shared-list');
        const snackbar = document.getElementById('snackbar');
        const snackbarClose = document.querySelector('.snackbar-close');

        // State
        let uploadedImages = [];
        let tags = [];
        let drafts = JSON.parse(localStorage.getItem('drafts')) || [];
        let sharedPosts = JSON.parse(localStorage.getItem('sharedPosts')) || [];
        let snackbarTimeout;

        // Navigation
        function showView(view) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            view.classList.remove('hidden');
        }

        uploadBtn.addEventListener('click', () => showView(uploadView));
        draftsBtn.addEventListener('click', () => {
            showView(draftsView);
            renderDrafts();
        });
        sharedBtn.addEventListener('click', () => {
            showView(sharedView);
            renderSharedPosts();
        });
        backToUploadBtn.addEventListener('click', () => {
            showView(uploadView);
            resetUploadSection();
        });

        // Image Upload
        addImageBtn.addEventListener('click', () => imageInput.click());
        imageInput.addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = (event) => {
                    uploadedImages.push(event.target.result);
                    renderImageGrid();
                };
                reader.readAsDataURL(file);
            });
        });

        function renderImageGrid() {
            imageGrid.innerHTML = '';
            uploadedImages.forEach((imgSrc, index) => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = `Uploaded image ${index + 1}`;
                imageGrid.appendChild(img);
            });
            const addButton = document.createElement('div');
            addButton.id = 'add-image-btn';
            addButton.className = 'add-button';
            addButton.textContent = '+ Add another';
            addButton.addEventListener('click', () => imageInput.click());
            imageGrid.appendChild(addButton);
        }

        // Tagging System
        const defaultTags = document.querySelectorAll('.default-tag');
        defaultTags.forEach(tag => {
            tag.addEventListener('click', () => {
                const tagValue = tag.getAttribute('data-tag');
                addTag(tagValue);
            });
        });

        tagInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                // Extract only the last text node (the new tag being typed)
                let newTag = '';
                for (let node of tagInput.childNodes) {
                    if (node.nodeType === Node.TEXT_NODE) {
                        const text = node.textContent.trim();
                        if (text) {
                            newTag = text;
                        }
                    }
                }
                if (newTag) {
                    addTag(newTag);
                    // Clear only the text nodes, keeping the tag spans
                    const children = Array.from(tagInput.childNodes);
                    children.forEach(node => {
                        if (node.nodeType === Node.TEXT_NODE) {
                            tagInput.removeChild(node);
                        }
                    });
                    tagInput.appendChild(document.createTextNode('\u00A0')); // Add space for typing
                    placeCaretAtEnd(tagInput);
                }
            }
        });

        tagInput.addEventListener('input', () => {
            // Remove any <div> or <br> tags that contenteditable might add
            if (tagInput.innerHTML.includes('<div>') || tagInput.innerHTML.includes('<br>')) {
                const children = Array.from(tagInput.childNodes);
                let newText = '';
                children.forEach(node => {
                    if (node.nodeType === Node.TEXT_NODE) {
                        const text = node.textContent.trim();
                        if (text) {
                            newText = text;
                        }
                    }
                });
                tagInput.innerHTML = '';
                tags.forEach(tag => {
                    const tagElement = document.createElement('span');
                    tagElement.className = 'tag';
                    tagElement.innerHTML = `${tag} <span class="remove-tag">✕</span>`;
                    tagElement.querySelector('.remove-tag').addEventListener('click', (e) => {
                        e.stopPropagation();
                        removeTag(tag);
                    });
                    tagInput.appendChild(tagElement);
                });
                tagInput.appendChild(document.createTextNode(newText || '\u00A0'));
                placeCaretAtEnd(tagInput);
            }
        });

        tagInput.addEventListener('click', () => {
            placeCaretAtEnd(tagInput);
        });

        function placeCaretAtEnd(el) {
            const range = document.createRange();
            const sel = window.getSelection();
            range.selectNodeContents(el);
            range.collapse(false);
            sel.removeAllRanges();
            sel.addRange(range);
        }

        function addTag(tagValue) {
            if (tags.length >= 10 || tags.includes(tagValue)) return;
            tags.push(tagValue);
            updateTagCounter();
            renderTags();
        }

        function removeTag(tagValue) {
            tags = tags.filter(tag => tag !== tagValue);
            updateTagCounter();
            renderTags();
        }

        function renderTags() {
            tagInput.innerHTML = '';
            tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'tag';
                tagElement.innerHTML = `${tag} <span class="remove-tag">✕</span>`;
                tagElement.querySelector('.remove-tag').addEventListener('click', (e) => {
                    e.stopPropagation();
                    removeTag(tag);
                });
                tagInput.appendChild(tagElement);
            });
            tagInput.appendChild(document.createTextNode('\u00A0')); // Add space for typing
            placeCaretAtEnd(tagInput);
        }

        function updateTagCounter() {
            const remaining = 10 - tags.length;
            tagCounter.textContent = `${remaining} tags remaining`;
        }

        // Show Snackbar
        function showSnackbar() {
            // Clear any existing timeout to prevent multiple timers
            if (snackbarTimeout) {
                clearTimeout(snackbarTimeout);
            }
            snackbar.classList.add('show');
            // Ensure the snackbar is in view
            snackbar.scrollIntoView({ behavior: 'smooth', block: 'end' });
            // Auto-hide after 2 seconds
            snackbarTimeout = setTimeout(() => {
                snackbar.classList.remove('show');
            }, 2000);
        }

        // Hide Snackbar when close button is clicked
        snackbarClose.addEventListener('click', () => {
            snackbar.classList.remove('show');
            if (snackbarTimeout) {
                clearTimeout(snackbarTimeout);
            }
        });

        // Save as Draft
        saveDraftBtn.addEventListener('click', () => {
            if (uploadedImages.length === 0) {
                alert('Please upload at least one image before saving as a draft.');
                return;
            }
            const draftName = prompt('Enter a name for this draft:');
            if (!draftName) return;
            const date = new Date().toLocaleString('en-US', {
                day: 'numeric',
                month: 'short',
                year: 'numeric',
                hour: 'numeric',
                minute: 'numeric',
                hour12: true
            });
            const newDraft = {
                name: draftName,
                images: uploadedImages,
                tags: tags,
                date: date
            };
            drafts.push(newDraft);
            localStorage.setItem('drafts', JSON.stringify(drafts));
            draftDate.textContent = date;
            // Show snackbar
            showSnackbar();
            resetUploadSection();
            renderDrafts();
        });

        // Share Now
        shareBtn.addEventListener('click', () => {
            if (uploadedImages.length === 0) {
                alert('Please upload at least one image before sharing.');
                return;
            }
            const date = new Date().toLocaleString('en-US', {
                day: 'numeric',
                month: 'short',
                year: 'numeric',
                hour: 'numeric',
                minute: 'numeric',
                hour12: true
            });
            const newPost = {
                images: uploadedImages,
                tags: tags,
                date: date
            };
            sharedPosts.push(newPost);
            localStorage.setItem('sharedPosts', JSON.stringify(sharedPosts));
            resetUploadSection();
            showView(sharedView);
            renderSharedPosts();
        });

        // Render Drafts
        function renderDrafts() {
            draftsList.innerHTML = '';
            drafts.forEach((draft, index) => {
                const draftElement = document.createElement('div');
                draftElement.className = 'draft-box';
                draftElement.innerHTML = `
                    <div class="draft-header">
                        <h3>${draft.name}</h3>
                        <span>${draft.date}</span>
                    </div>
                    <div class="image-grid"></div>
                    <div class="tags">
                        ${draft.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `;
                const draftImageGrid = draftElement.querySelector('.image-grid');
                draft.images.forEach(imgSrc => {
                    const img = document.createElement('img');
                    img.src = imgSrc;
                    img.alt = 'Draft image';
                    draftImageGrid.appendChild(img);
                });
                draftElement.addEventListener('click', () => {
                    uploadedImages = draft.images;
                    tags = draft.tags;
                    showView(uploadView);
                    renderImageGrid();
                    renderTags();
                    updateTagCounter();
                });
                draftsList.appendChild(draftElement);
            });
        }

        // Render Shared Posts
        function renderSharedPosts() {
            sharedList.innerHTML = '';
            sharedPosts.forEach((post, index) => {
                const postElement = document.createElement('div');
                postElement.className = 'shared-box';
                postElement.innerHTML = `
                    <div class="post-header">
                        <h3>Shared Post ${index + 1}</h3>
                        <span>${post.date}</span>
                    </div>
                    <div class="image-grid"></div>
                    <div class="tags">
                        ${post.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                `;
                const postImageGrid = postElement.querySelector('.image-grid');
                post.images.forEach(imgSrc => {
                    const img = document.createElement('img');
                    img.src = imgSrc;
                    img.alt = 'Shared image';
                    postImageGrid.appendChild(img);
                });
                postElement.addEventListener('click', () => {
                    uploadedImages = post.images;
                    tags = post.tags;
                    showView(uploadView);
                    renderImageGrid();
                    renderTags();
                    updateTagCounter();
                });
                sharedList.appendChild(postElement);
            });
        }

        // Reset Upload Section
        function resetUploadSection() {
            uploadedImages = [];
            tags = [];
            imageGrid.innerHTML = '';
            tagInput.innerHTML = '';
            draftDate.textContent = '';
            updateTagCounter();
            renderImageGrid();
            // Scroll to the top to ensure the content starts from the beginning
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize
        updateTagCounter();
        renderDrafts();
        renderSharedPosts();
        renderImageGrid();
    </script>
</body>
</html>